name = "9to5-scout"
main = "src/index.ts"
compatibility_date = "2024-05-01"
compatibility_flags = ["nodejs_compat"]

[observability.logs]
enabled = true

[browser]
binding = "MYBROWSER"

[[d1_databases]]
binding = "DB"
database_name = "JOB_SCRAPER_DB"
database_id = "11092798-a3d9-44b8-be5f-1835c0027887"

[[kv_namespaces]]
binding = "KV"
id = "5e60b00818e9448b8f965af0fc96d39a"

[[r2_buckets]]
binding = "R2"
bucket_name = "job-scraper"

[[vectorize]]
binding = "VECTORIZE_INDEX"
index_name = "jobs"

[ai]
binding = "AI"

[[services]]
binding = "SERVICE"
service = "9to5-scraper"

[durable_objects]
bindings = [
  { name = "SITE_CRAWLER", class_name = "SiteCrawler" },
  { name = "JOB_MONITOR", class_name = "JobMonitor" }
]

[[workflows]]
name = "discovery-workflow"
binding = "DISCOVERY_WORKFLOW"
class_name = "DiscoveryWorkflow"

[[workflows]]
name = "job-monitor-workflow"
binding = "JOB_MONITOR_WORKFLOW"
class_name = "JobMonitorWorkflow"

[[workflows]]
name = "change-analysis-workflow"
binding = "CHANGE_ANALYSIS_WORKFLOW"
class_name = "ChangeAnalysisWorkflow"

[[migrations]]
tag = "v1"
new_sqlite_classes = ["SiteCrawler", "JobMonitor"]

[vars]
API_AUTH_TOKEN = "test-token"
BROWSER_RENDERING_TOKEN = "browser-token"
SLACK_WEBHOOK_URL = ""
SMTP_ENDPOINT = ""
SMTP_USERNAME = ""
SMTP_PASSWORD = ""

[triggers]
crons = [
  "*/15 * * * *", # every 15 minutes
  "0 6 * * *"     # daily 06:00
]

[assets]
binding = "ASSETS"
directory = "./public"

[env.preview]

